(self.webpackChunkextension=self.webpackChunkextension||[]).push([[9706],{94383:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>rt});var n=r(11999),a=r(7527),o=r(50122),l=r(89338),i=r(2827),c=r.n(i),s=r(22155),u=r(30395),d=r.n(u),p=r(14243),f=r(5947),v=r(94198),m=r(67380),y=r(53823),b=r(83448),g=r(96888),C=r(43918),k=r(41536),h=r(16763),w=r(9487),O=r(61663),P=r(11924),S=r(57952),A=r(68390),N=r(54883),E=r(70591),R=s.createElement;function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){(0,o.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var T="INTRO",F="AWARD",I={USER:{START:S.VB.StartAwardUser,PICK:S.VB.PickAwardUser,AWARD:S.VB.AwardUser},POST:{START:S.VB.StartAwardPost,PICK:S.VB.PickAwardPost,AWARD:S.VB.AwardPost},COMMENT:{START:S.VB.StartAwardComment,PICK:S.VB.PickAwardComment,AWARD:S.VB.AwardComment}},_=s.createContext(void 0);var D=function(e){var t=e.children,r=e.onRequestClose,n=e.type,a=e.entity,o=e.post,l=(0,w.useRouter)(),i=(0,O.DX)().logEvent,c=(0,s.useState)({screen:T}),u=c[0],d=c[1],p=(0,s.useState)(F),f=p[0],v=p[1],m=(0,s.useCallback)((function(e){var t,r=e.awardEvent,a=e.extra,l=null===(t=I[n])||void 0===t?void 0:t[r];i("USER"===n?{event_name:l,extra:JSON.stringify(j({},a))}:(0,P.P5)(l,o,{extra:a}))}),[i,o,n]),y=(0,s.useMemo)((function(){return{activeModal:f,setActiveModal:function(e){if("BUY_CORES"===e&&(0,A.oX)()){var t=new URLSearchParams({origin:S.$e.Award});return null!=o&&o.id&&t.append("next","/posts/".concat(o.id)),void(null==l||l.replace((0,E.Lz)("".concat(N.ZO,"cores"),t)))}v(e)},onRequestClose:r,activeStep:u.screen,product:u.product,setActiveStep:d,type:n,entity:a,logAwardEvent:m}}),[f,r,u.screen,u.product,n,a,m,l,o]);return R(_.Provider,{value:y},t)},B=function(){return(0,s.useContext)(_)},M=r(16714),L=r(24481),X=r(72870),U=r(68392),K=r(77955),V=r(97838),z=r(59904),q=r(95974),G=r(76800),Z=r(80244),$=r(81602),W=s.createElement,Y=function(e){var t,r=e.className,n=e.onPlusClick,a=e.hideBuyButton,o=null!==(0,K.k3)().onRequestClose,l=(0,Z.Z2)().user,i=!a,c=(0,O.DX)().logEvent;return W("div",{className:d()("flex items-center rounded-10 bg-surface-float",r)},W(q.A,{href:N.JY,passHref:!0},W(y.$n,{tag:"a",target:o?"_blank":void 0,rel:G.O8,variant:b.Ak.Tertiary,icon:W(g.t,null),size:b.Mp.Small},(0,$.Kt)((null==l||null===(t=l.balance)||void 0===t?void 0:t.amount)||0))),i?W(s.Fragment,null,W("div",{className:"h-[1.375rem] w-px bg-border-subtlest-tertiary"}),W(y.$n,{variant:b.Ak.Tertiary,icon:W(z.c,null),size:b.Mp.Small,onClick:function(){c({event_name:S.VB.StartBuyingCredits,extra:JSON.stringify({origin:S.$e.Award})}),null==n||n()}})):null)},H=r(75087),J=r(69918),Q=r(38166),ee=r.n(Q),te=r(89113),re=r(63982),ne=r(37567),ae=s.createElement;function oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var le="INTRO",ie="PROCESSING",ce=s.createContext(void 0);var se=function(e){var t=e.onCompletion,r=e.origin,n=e.amountNeeded,a=e.children,l=(0,O.DX)().logEvent,i=(0,Z.Z2)(),c=i.user,u=i.geo,d=i.isLoggedIn,f=(0,s.useState)({step:le}),v=f[0],m=f[1],y=(0,s.useState)(),b=y[0],g=y[1],C=(0,s.useState)(),k=C[0],h=C[1],w=s.useRef(!1),P=(0,s.useRef)();P.current=l;var N=(0,p.I)((0,ne.ZN)({user:c,isLoggedIn:d})).data,E=function(e){var t=e.priceId;return(0,ne.WP)({priceId:t,prices:N})},R=(0,s.useRef)(E);R.current=E,(0,s.useEffect)((function(){(0,A.oX)()||(w.current=!1,(0,re.initializePaddle)({environment:"MISSING_ENV_VAR".NEXT_PUBLIC_PADDLE_ENVIRONMENT||"production",token:"topsecret",eventCallback:function(e){var t,r,n,a;switch(null==e?void 0:e.name){case re.CheckoutEventNames.CHECKOUT_PAYMENT_INITIATED:P.current({event_name:S.VB.InitiatePayment,target_type:S.yK.Credits,target_id:null==e||null===(t=e.data)||void 0===t?void 0:t.payment.method_details.type});break;case re.CheckoutEventNames.CHECKOUT_LOADED:w.current=!0,P.current({event_name:S.VB.InitiateCheckout,target_type:S.yK.Credits,target_id:null==e||null===(r=e.data)||void 0===r?void 0:r.payment.method_details.type});break;case re.CheckoutEventNames.CHECKOUT_PAYMENT_SELECTED:P.current({event_name:S.VB.SelectCheckoutPayment,target_type:S.yK.Credits,target_id:null==e||null===(n=e.data)||void 0===n?void 0:n.payment.method_details.type});break;case re.CheckoutEventNames.CHECKOUT_COMPLETED:P.current({event_name:S.VB.CompleteCheckout,target_type:S.yK.Credits,extra:JSON.stringify({user_id:"user_id"in e.data.custom_data?e.data.custom_data.user_id:void 0,quantity:R.current({priceId:null===(a=e.data.items[0])||void 0===a?void 0:a.price_id}),localCost:null==e?void 0:e.data.totals.total,localCurrency:null==e?void 0:e.data.currency_code,payment:null==e?void 0:e.data.payment.method_details.type})}),m({step:ie,providerTransactionId:e.data.transaction_id});break;case"checkout.warning":P.current({event_name:S.VB.WarningCheckout,target_type:S.yK.Credits});break;case re.CheckoutEventNames.CHECKOUT_ERROR:P.current({event_name:S.VB.ErrorCheckout,target_type:S.yK.Credits});break;case re.CheckoutEventNames.CHECKOUT_CLOSED:w.current=!1}},checkout:{settings:{displayMode:"inline",frameTarget:"checkout-container",frameInitialHeight:500,frameStyle:"width: 100%; background-color: transparent; border: none;",theme:"dark",variant:"one-page"}}}).then((function(e){e&&h(e)})))}),[]);var x=(0,s.useCallback)((function(e){var t=[{priceId:e.priceId,quantity:1}],r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(r),!0).forEach((function(t){(0,o.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({email:null==c?void 0:c.email},(null==u?void 0:u.region)&&{address:{countryCode:null==u?void 0:u.region}}),n={user_id:null==c?void 0:c.id};w.current?null==k||k.Checkout.updateItems(t):null==k||k.Checkout.open({items:t,customer:r,customData:n})}),[null==k?void 0:k.Checkout,null==c?void 0:c.email,null==c?void 0:c.id,null==u?void 0:u.region]),j=(0,s.useMemo)((function(){return{paddle:k,amountNeeded:n,onCompletion:t,activeStep:v.step,error:v.error,setActiveStep:m,selectedProduct:b,setSelectedProduct:g,openCheckout:x,providerTransactionId:v.providerTransactionId,origin:r}}),[v,n,t,x,r,k,b]);return ae(ce.Provider,{value:j},a)},ue=function(){return(0,s.useContext)(ce)},de=s.createElement,pe=function(e){var t=e.id,r=e.priceFormatted,n=e.cores,a=e.label,o=(0,X.G6)(X.bh.MobileL),l=(0,O.DX)().logEvent,i=ue(),c=i.selectedProduct,u=i.setSelectedProduct,p=i.openCheckout,f=i.origin,v=i.paddle,g=(0,s.useCallback)((function(){l({event_name:S.VB.SelectCreditsQuantity,extra:JSON.stringify({origin:f,quantity:null==c?void 0:c.value})}),u({id:t,value:n}),o||p({priceId:t})}),[l,f,t,u,n,o,p,c]);return de(y.$n,{className:d()("w-full",(null==c?void 0:c.id)===t?"border-action-cores-default bg-action-cores-float":void 0),variant:b.Ak.Float,icon:de(k._V,{className:"mr-2 size-8",src:(0,h.qQ)(n)}),size:b.Mp.Large,"aria-checked":(null==c?void 0:c.id)===t,role:"radio",onClick:g,disabled:!v},de(m.o5,{type:m.kR.Body,color:m.X8.Primary,bold:!0},a),de("div",{className:"flex-1"}),de(m.o5,{type:m.kR.Callout,color:m.X8.Tertiary,className:"font-normal"},r))},fe=function(){return de(y.$n,{className:"w-full",variant:b.Ak.Float,size:b.Mp.Large,disabled:!0},de(m.o5,{type:m.kR.Body,color:m.X8.Primary,bold:!0}))},ve=s.createElement,me=function(){var e=(0,Z.Z2)(),t=e.user,r=e.isLoggedIn,n=(0,p.I)((0,ne.ZN)({user:t,isLoggedIn:r})),a=n.data,o=n.isPending;return ve("ul",{className:"mt-4 flex flex-col gap-2",role:"radiogroup"},o&&new Array(9).fill(null).map((function(e,t){return ve(fe,{key:t})})),!o&&(null==a?void 0:a.map((function(e){return ve(pe,{key:e.value,id:e.value,label:e.label,cores:e.coresValue,priceFormatted:e.price.formatted})}))))},ye=r(73855),be=s.createElement,ge=function(){var e=ue(),t=e.amountNeeded,r=e.selectedProduct;return t&&r?be(s.Fragment,null,be(m.o5,{className:"w-full flex-1",type:m.kR.Callout,color:m.X8.Secondary},be(m.o5,{tag:m.UL.Span,color:m.X8.Primary,bold:!0},(0,ye.rZ)(t)," Cores")," ","will be used to give the Award. The remaining"," ",be(m.o5,{tag:m.UL.Span,color:m.X8.Primary,bold:!0},(0,ye.rZ)(r.value-t)," Cores")," ","will be added to your balance.")):be(m.o5,{className:"w-full flex-1",type:m.kR.Callout,color:m.X8.Secondary},"Choose how many Cores to buy.")},Ce=r(30530),ke=r(53143),he=r(30794),we=r(61027);var Oe,Pe=r(4315),Se=r(13713),Ae=["origin","onCompletion","product"],Ne=s.createElement;function Ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(r),!0).forEach((function(t){(0,o.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var xe=function(e){var t=e.className,r=e.title,n=e.showCoresAtCheckout;return Ne("div",{className:d()("flex-1",t)},r,Ne("div",{className:"flex flex-1 items-center justify-between gap-4"},Ne(ge,null),!!n&&Ne(Y,{hideBuyButton:!0})),Ne(me,null))},je=function(e){var t=e.className,r=(0,we.p)();return Ne("div",{className:d()("flex-1",r&&"bg-black",t)},Ne("div",{className:"checkout-container"}))},Te=(Oe={},(0,o.A)(Oe,ne.kr.Created,"Checking your data..."),(0,o.A)(Oe,ne.kr.Processing,"Processing your payment, please wait..."),(0,o.A)(Oe,ne.kr.Success,"Almost done..."),(0,o.A)(Oe,ne.kr.ErrorRecoverable,"There was an issue, retrying..."),(0,o.A)(Oe,ne.kr.Error,Ne(s.Fragment,null,"Something went wrong!",Ne("br",null),Ne(ee(),{href:N.JY},Ne(m.o5,{type:m.kR.Footnote},Ne("u",null,"check status here"))))),Oe),Fe=function(e){var t=e.transaction,r=Te[null==t?void 0:t.status]||Te[ne.kr.Processing],n=(null==t?void 0:t.status)===ne.kr.Error;return Ne(s.Fragment,null,Ne(g.t,{size:V.lK.XXXLarge}),Ne(m.o5,{type:m.kR.Title3,bold:!0},r),!n&&Ne(he.a,{className:"hidden tablet:block"}))},Ie=function(){var e=ue(),t=e.onCompletion,r=e.selectedProduct;return Ne(s.Fragment,null,Ne(g.t,{size:V.lK.XXXLarge}),Ne(m.o5,{type:m.kR.LargeTitle,bold:!0},(0,ye.rZ)(r.value)),Ne(m.o5,{type:m.kR.Title3,bold:!0},"You got your Cores!"),Ne(m.o5,{type:m.kR.Callout,color:m.X8.Tertiary},"Success! Your Cores are now available in your balance."),Ne(y.$n,{onClick:t,variant:b.Ak.Primary,className:"w-full"},"Got it"))},_e=function(){var e=ue().error||{},t=e.title,r=e.description,n=e.onRequestClose;return Ne(s.Fragment,null,Ne(g.t,{size:V.lK.XXXLarge}),Ne(m.o5,{type:m.kR.Title3,bold:!0},t||"There was an error processing your transaction."),r&&Ne(m.o5,{type:m.kR.Callout,color:m.X8.Tertiary},r),Ne(y.$n,{onClick:function(){null==n||n()},variant:b.Ak.Primary,className:"w-full"},"Got it"))},De=function(e){var t,r=(0,a.A)({},((0,n.A)(e),e)),o=(0,w.useRouter)(),i=(0,Z.Z2)(),u=i.user,d=i.updateUser,f=ue(),m=f.onCompletion,y=f.activeStep,b=f.setActiveStep,g=f.error,C="PROCESSING"===y,k=(0,J.jE)(),h=(0,s.useCallback)((function(){return!C}),[C]),O=function(e){var t=e.message,r=void 0===t?"You have unsaved changes that will be lost if you leave the page":t,n=e.onValidateAction,a=(0,s.useRef)(!0),o=(0,w.useRouter)(),l=(0,s.useCallback)((function(){return!a.current||n()}),[n]);return(0,s.useEffect)((function(){if(o.isReady){var e=function(e){l()||(e.preventDefault(),e.returnValue=r)},t=function(){if(!l()&&!confirm(r))throw o.events.emit("routeChangeError"),new Error("Cancelling navigation")};return window.addEventListener("beforeunload",e),o.events.on("routeChangeStart",t),function(){window.removeEventListener("beforeunload",e),o.events.off("routeChangeStart",t)}}}),[l,r,o]),{onAskConfirmation:function(e){a.current=e}}}({message:Pe.W.cores.error.transactionProcessing.description,onValidateAction:h}),P=O.onAskConfirmation,S=ue().providerTransactionId,A=(0,p.I)({queryKey:[Ce.jZ.Transactions,{providerId:S}],queryFn:(t=(0,l.A)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ne.FW)({providerId:S});case 2:return null!=(t=e.sent)&&t.balance&&d(Re(Re({},u),{},{balance:t.balance})),k.invalidateQueries({queryKey:(0,Ce.$h)(Ce.jZ.Transactions,u),exact:!1}),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)}),enabled:!!S,refetchInterval:function(e){var t,r=null===(t=e.state.data)||void 0===t?void 0:t.status;return Math.max(e.state.dataUpdateCount,e.state.fetchFailureCount)>1e3*ke.xP/ne.Np?(P(!1),b({step:"PROCESSING_ERROR",error:{title:"Processing timed out",description:"Please check the status of your transaction in your Core Wallet.",onRequestClose:function(){o.push(N.JY)}}}),!1):[ne.kr.Created,ne.kr.Processing,ne.kr.ErrorRecoverable].includes(r)?ne.Np:([ne.kr.Error,ne.kr.InternalError].includes(r)&&(b({step:"PROCESSING_ERROR",error:{title:"There was an issue processing your transaction.",description:"Please contact support.",onRequestClose:function(){b({step:"INTRO"})}}}),P(!1)),!1)}}),E=A.data;return(0,s.useEffect)((function(){(null==E?void 0:E.status)===ne.kr.Success&&b({step:"COMPLETED",providerTransactionId:S})}),[null==E?void 0:E.status,S,b]),Ne(v.aF,(0,a.A)({kind:v.aF.Kind.FlexibleCenter,size:v.aF.Size.XSmall},r,{onRequestClose:function(){var e;return"PROCESSING_ERROR"===y?null==g||null===(e=g.onRequestClose)||void 0===e?void 0:e.call(g):m()},isDrawerOnMobile:!0}),Ne(v.aF.Body,{className:"flex items-center justify-center gap-4 text-center"},C&&Ne(Fe,{transaction:E}),"COMPLETED"===y&&Ne(Ie,null),"PROCESSING_ERROR"===y&&Ne(_e,null)))},Be=function(){var e=ue(),t=e.selectedProduct,r=e.openCheckout,n=e.paddle;return(0,s.useEffect)((function(){n&&t&&r({priceId:t.id})}),[r,t,n]),Ne(te.c,{className:d()("bg-gradient-to-t from-theme-overlay-float-bun to-transparent",t&&"!p-0")},t?Ne(je,{className:"p-6"}):Ne(xe,null))},Me=function(){return Ne("div",{className:"relative flex h-[582px] max-h-full flex-1"},Ne("video",{className:"bg-blue-500 absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 transform",poster:h.Ik,src:h.$0,muted:!0,autoPlay:!0,loop:!0,playsInline:!0,disablePictureInPicture:!0,controls:!1}))},Le=function(){var e=ue().selectedProduct;return Ne(te.c,{className:d()("bg-gradient-to-t from-theme-overlay-float-bun to-transparent !p-0 tablet:rounded-b-16")},Ne("div",{className:"flex flex-1 flex-row"},Ne(xe,{className:"p-6"}),Ne(je,{className:d()(!e&&"hidden","rounded-br-16 p-6")}),Ne("div",{className:d()("flex flex-1 overflow-hidden rounded-br-16",e&&"hidden")},!e&&Ne(Me,null))))},Xe=function(e){var t=(0,a.A)({},((0,n.A)(e),e)),r=B().setActiveModal,o=(0,X.G6)(X.bh.MobileL),l=(0,Se.P_)();return Ne(v.aF,(0,a.A)({kind:o?K.UB.FlexibleTop:v.aF.Kind.FlexibleCenter,size:v.aF.Size.XLarge,className:d()(o?void 0:"!h-[40rem]")},t),Ne(v.aF.Header,{title:o?void 0:"Get More Cores",className:"mr-auto flex-row-reverse justify-between gap-4 laptop:justify-end",showCloseButton:!o},Ne(Y,{hideBuyButton:!l,onPlusClick:function(){return r("BUY_CORES")}}),o&&Ne(y.$n,{onClick:t.onRequestClose,variant:b.Ak.Tertiary,size:b.Mp.Small,className:"mr-2"},"Close")),Ne(o?Be:Le,null))},Ue=function(e){var t=ue().activeStep;return["PROCESSING","COMPLETED","PROCESSING_ERROR"].includes(t)?Ne(De,e):null},Ke=function(e){var t=(0,a.A)({},((0,n.A)(e),e)),r=ue().activeStep;return Ne(s.Fragment,null,Ne(Ue,t),"INTRO"===r&&Ne(Xe,t))},Ve=function(e){var t=e.origin,r=e.onCompletion,n=e.product,a=(0,H.A)(e,Ae);return Ne(se,{amountNeeded:null==n?void 0:n.value,onCompletion:r,origin:t},Ne(Ke,a))},ze=r(36899),qe=s.createElement,Ge=function(e){var t=e.className;return qe(m.o5,{type:m.kR.Footnote,color:m.X8.Quaternary,className:d()("text-center",t)},"Awards may include a revenue share with the recipient and are subject to our"," ",qe("a",{href:N.uW,target:"_blank",rel:G.O8,className:"font-bold underline"},"Terms of Service"),".")},Ze=s.createElement;function $e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function We(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(r),!0).forEach((function(t){(0,o.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ye=function(e){var t=e.item,r=e.onClick,n=B().logAwardEvent;return Ze(y.$n,{variant:b.Ak.Float,className:"flex !h-auto flex-col items-center justify-center rounded-14 bg-surface-float !p-1",onClick:function(e){return n({awardEvent:"PICK",extra:{award:t.value}}),r({product:t,event:e})}},Ze(k._V,{src:t.image,alt:t.name,className:"size-20 object-contain"}),Ze("div",{className:"flex items-center justify-center gap-1"},Ze(g.t,{size:V.lK.Size16}),Ze(m.o5,{type:m.kR.Footnote,color:m.X8.Secondary,tag:m.UL.Span},0===t.value?"Free":(0,ye.rZ)(t.value))))},He=function(){var e,t=(0,s.useState)(!1),r=t[0],n=t[1],a=(0,Z.Z2)().user,o=B(),l=o.onRequestClose,i=o.entity,c=o.setActiveModal,u=o.setActiveStep,f=o.product,C=(0,X.G6)(X.bh.MobileL),w=(0,Se.P_)(),O=(0,p.I)({queryKey:(0,Ce.$h)(Ce.jZ.Products),queryFn:function(){return(0,ne.d$)()},staleTime:Ce.b2.Default}).data,P=function(){n(!1),c("BUY_CORES")},S=!!i.numAwards;return Ze(s.Fragment,null,Ze(v.aF.Header,{showCloseButton:!C,className:d()(C?"flex-row-reverse justify-between":void 0)},Ze(Y,{hideBuyButton:!w,onPlusClick:P}),C?Ze(y.$n,{onClick:l,variant:b.Ak.Tertiary,size:b.Mp.Small,className:"mr-2"},"Close"):null),Ze(v.aF.Body,{className:"bg-gradient-to-t from-theme-overlay-to to-transparent tablet:rounded-b-16"},Ze("div",{className:"flex flex-col items-center justify-center gap-2 p-4"},Ze(k._V,{src:S?h.Xr:i.receiver.image,alt:"Award user",className:S?"size-[7.5rem]":"size-16 rounded-18"}),Ze(m.o5,{type:m.kR.Title3,bold:!0,color:m.X8.Primary},S?Ze(s.Fragment,null,(0,$.Kt)(i.numAwards)," Awards given"):Ze(s.Fragment,null,"Give an Award"))),Ze(m.o5,{type:m.kR.Callout,color:m.X8.Tertiary,className:"text-center"},"Show your appreciation! Pick an Award to send to"," ",Ze(m.o5,{type:m.kR.Callout,color:m.X8.Primary,tag:m.UL.Span,bold:!0},i.receiver.name||"@".concat(i.receiver.username)),"!"),Ze("div",{className:"mt-4 grid grid-cols-3 gap-2 tablet:grid-cols-4"},null==O||null===(e=O.edges)||void 0===e?void 0:e.map((function(e){var t=e.node;return Ze(Ye,{key:t.id,item:t,onClick:function(e){var t=e.product;if(t.value>a.balance.amount)return u({screen:"INTRO",product:t}),void n(!0);n(!1),u({screen:"COMMENT",product:t})}})})))),r&&!!f&&Ze(v.aF.Footer,{className:"!h-auto flex-col",justify:M.F1.Center},w&&Ze(y.$n,{className:"w-full",variant:b.Ak.Primary,onClick:P},"Buy Cores ",Ze(g.t,null)," ",0===f.value?"Free":(0,ye.rZ)(f.value)),!w&&Ze(y.$n,{className:"w-full",variant:b.Ak.Primary,disabled:!0},Ze("span",{className:"inline-flex gap-1"}," ","Insufficient Cores",Ze(g.t,{secondary:!0})," "),0===f.value?"Free":(0,ye.rZ)(f.value)),Ze(Ge,null)))},Je=function(){var e,t,r=(0,Z.Z2)(),n=r.updateUser,a=r.user,o=B(),i=o.setActiveStep,u=o.type,d=o.entity,p=o.product,h=o.logAwardEvent,w=(0,X.G6)(X.bh.MobileL),O=(0,U.mu)().displayToast,P=(0,s.useState)(""),S=P[0],A=P[1],N=(0,f.n)({mutationKey:["awards",{productId:null==p?void 0:p.id,type:u,entityId:d.id,note:S}],mutationFn:ne.CX,onSuccess:(t=(0,l.A)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(We(We({},a),{},{balance:t.balance}));case 2:i({screen:"SUCCESS",product:p});case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)}),onError:(e=(0,l.A)(c().mark((function e(t){var r,o,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===(r=t.response.errors)||void 0===r||null===(r=r[0])||void 0===r||null===(r=r.extensions)||void 0===r?void 0:r.code)!==ze.hD.BalanceTransactionError){e.next=5;break}if((l=t.response.errors[0]).extensions.status!==ne.kr.InsufficientFunds||!l.extensions.balance){e.next=5;break}return e.next=5,n(We(We({},a),{},{balance:l.extensions.balance}));case 5:O((null==t||null===(o=t.response)||void 0===o||null===(o=o.errors)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.message)||Pe.W.error.generic);case 6:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})}),E=N.mutate,R=N.isPending,x=(0,s.useCallback)((function(){h({awardEvent:"AWARD",extra:{award:p.value}}),E({productId:p.id,type:u,entityId:d.id,note:S})}),[E,d.id,h,S,p.id,p.value,u]),j=!!d.numAwards;return Ze(s.Fragment,null,Ze(v.aF.Header,{title:"Give an Award",showCloseButton:!w},Ze(y.$n,{variant:b.Ak.Tertiary,onClick:function(){return i({screen:"INTRO"})},size:b.Mp.Small,className:"mr-2 flex -rotate-90",icon:Ze(C.HK,null)})),Ze(v.aF.Body,null,Ze("div",{className:"mb-4 flex flex-col items-center justify-center gap-2"},Ze(k._V,{src:j?p.image:d.receiver.image,alt:"Award user",className:j?"size-[7.5rem]":"size-16 rounded-18"}),Ze(m.o5,{type:m.kR.Callout,color:m.X8.Tertiary,className:"text-center"},"Awesome choice! We're sure that"," ",Ze(m.o5,{bold:!0,type:m.kR.Callout,color:m.X8.Primary,tag:m.UL.Span},d.receiver.name||"@".concat(d.receiver.username))," ","will appreciate this award!")),Ze("form",{action:"#",className:"flex flex-1 flex-col"},Ze(L.A,{allowPreview:!1,textareaProps:{name:"content",rows:6,placeholder:"Share a few words about why this Award is well deserved (optional)",maxLength:400},className:{container:"flex-1"},initialContent:"",enabledCommand:{upload:!1,link:!1,mention:!1},showMarkdownGuide:!1,onValueUpdate:function(e){return A(e)}}))),Ze(v.aF.Footer,{className:"!h-auto flex-col",justify:M.F1.Center},Ze(y.$n,{loading:R,className:"w-full",variant:b.Ak.Primary,onClick:x},"Send Award for ",Ze(g.t,null)," ",0===p.value?"Free":(0,ye.rZ)(p.value)),Ze(Ge,null)))},Qe=function(){var e,t=B(),r=t.entity,n=t.product,a=t.onRequestClose,o=(0,X.G6)(X.bh.MobileL);return Ze(v.aF.Body,null,Ze("div",{className:"flex flex-col items-center justify-center gap-4"},Ze("div",{className:"flex flex-col gap-2"},Ze(k._V,{src:n.image,alt:null==n||null===(e=n.flags)||void 0===e?void 0:e.description,className:"size-20"}),Ze("div",{className:"flex items-center justify-center gap-1"},Ze(g.t,{size:V.lK.Size16,className:"text-accent-bun-default"}),Ze(m.o5,{type:m.kR.Footnote,color:m.X8.Secondary,tag:m.UL.Span},0===n.value?"Free":(0,ye.rZ)(n.value)))),Ze("div",{className:"flex flex-col gap-2"},Ze(m.o5,{type:m.kR.Title3,color:m.X8.Primary,bold:!0,className:"text-center"},"Congrats! Your Award has been sent to"," ",r.receiver.name||"@".concat(r.receiver.username)),Ze(m.o5,{type:m.kR.Callout,color:m.X8.Tertiary,className:"text-center"},"Thanks for supporting the community!")),!o&&Ze(y.$n,{variant:b.Ak.Primary,className:"w-full",onClick:function(){a(void 0)}},"Close")))},et=function(){var e=B().activeStep;return Ze(s.Fragment,null,"INTRO"===e?Ze(He,null):null,"COMMENT"===e?Ze(Je,null):null,"SUCCESS"===e?Ze(Qe,null):null)},tt=function(e){var t=(0,a.A)({},((0,n.A)(e),e)),r=(0,X.G6)(X.bh.MobileL),o=B(),l=o.activeStep,i=o.activeModal,c=o.setActiveModal,u=o.product,p=o.logAwardEvent,f=(0,s.useRef)(!1);(0,s.useEffect)((function(){f.current||(f.current=!0,p({awardEvent:"START"}))}),[p]);var m=(0,s.useCallback)((function(){c("AWARD")}),[c]),y=(0,s.useCallback)((function(){c("AWARD")}),[c]);return Ze(s.Fragment,null,"AWARD"===i?Ze(v.aF,(0,a.A)({kind:r?K.UB.FlexibleTop:v.aF.Kind.FlexibleCenter,size:v.aF.Size.Small,className:d()(r||"SUCCESS"===l?void 0:"!h-[40rem]"),isDrawerOnMobile:"SUCCESS"===l,drawerProps:{instantOpen:!0}},t),Ze(et,null)):null,"BUY_CORES"===i?Ze(Ve,(0,a.A)({},t,{onCompletion:m,onRequestClose:y,product:u,origin:S.$e.Award})):null)};const rt=function(e){return Ze(D,e,Ze(tt,e))}},73855:(e,t,r)=>{"use strict";r.d(t,{PK:()=>l,rZ:()=>c,vv:()=>i});var n=r(50122),a=r(81602);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var l=function(e){return"string"==typeof e&&"true"===e.toLowerCase()},i=function(e,t){return"number"!=typeof e?"":e.toLocaleString(["en-US"],function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({minimumFractionDigits:2,maximumFractionDigits:2},t))},c=function(e){return e>1e5?(0,a.Kt)(e):i(e,{minimumFractionDigits:0})}},63982:()=>{},11999:(e,t,r)=>{"use strict";function n(e){if(null==e)throw new TypeError("Cannot destructure "+e)}r.d(t,{A:()=>n})}}]);