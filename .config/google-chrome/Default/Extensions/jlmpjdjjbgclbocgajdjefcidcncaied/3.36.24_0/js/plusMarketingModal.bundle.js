(self.webpackChunkextension=self.webpackChunkextension||[]).push([[8440],{85057:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>E});var a=n(7527),r=n(22155),i=n(36797),o=n.n(i),l=n(94198),u=n(68390),c=n(72046),d=n(72870),s=n(74689),v=n(89883),m=n(4979),f=n(65323),p=n(61663),b=n(57952),C=n(77955),g=r.createElement,y=o()((function(){return n.e(1394).then(n.bind(n,3059))}),{loadableGenerated:{webpack:function(){return[3059]}}}),h=o()((function(){return Promise.all([n.e(938),n.e(1278)]).then(n.bind(n,35791))}),{loadableGenerated:{webpack:function(){return[35791]}}}),k=o()((function(){return Promise.all([n.e(938),n.e(6656)]).then(n.bind(n,9447))}),{loadableGenerated:{webpack:function(){return[9447]}}}),P=o()((function(){return Promise.all([n.e(938),n.e(354)]).then(n.bind(n,36691)).then((function(e){return e.PlusIOS}))}),{loadableGenerated:{webpack:function(){return[36691]}}});const E=function(e){var t=(0,c.o)(),n=t.getMarketingCta,i=t.clearMarketingCta,o=n(f.WA.Plus).campaignId,E=(0,p.DX)().logEvent,_=(0,v.d)().closeModal,O=(0,u.oX)(),I=(0,d.G6)(d.bh.Tablet),w=function(){E({event_name:b.VB.MarketingCtaDismiss,target_type:b.yK.MarketingCtaPlus,target_id:o}),_(),i(o)},T=(0,r.useMemo)((function(){return(0,u.Ji)()?g(P,{showModalSection:!0}):g(O?h:k,null)}),[O]);return I?g(m.P,null,g(l.aF,(0,a.A)({size:C.rI.XLarge,className:"flex-1 overflow-x-hidden !bg-background-default"},e,{onRequestClose:w}),g(l.aF.Body,{className:"!p-0"},g(s.O,{onClick:w,top:"4"}),T))):g(y,(0,a.A)({onClose:w},e))}},20573:(e,t,n)=>{"use strict";n.d(t,{P:()=>i,Q:()=>r});var a=n(22155),r=(0,a.createContext)(void 0),i=function(){var e=(0,a.useContext)(r);if(void 0===e)throw new Error("usePaymentContext must be used within a PaymentContextProvider");return e}},4979:(e,t,n)=>{"use strict";n.d(t,{P:()=>S});var a=n(22155),r=n(36797),i=n.n(r),o=n(68390),l=n(50122),u=n(89338),c=n(2827),d=n.n(c),s=n(24021),v=n(14243),m=n(9487),f=n(80244),p=n(54883),b=n(92315),C=n(55551),g=n(16354),y=n(81602),h=n(62424),k=n(20573),P=n(93961),E=(0,a.createContext)({trackSignup:function(){},trackPayment:function(){},trackEvent:function(){}}),_=n(57952);var O=function(e){var t=e.paddleCallback,n=e.disabledEvents,r=(0,a.useContext)(E).trackPayment,i=(0,a.useState)(),l=i[0],u=i[1],c=(0,b.L)().logSubscriptionEvent,d=(0,a.useRef)();return(0,a.useEffect)((function(){d.current=function(e,t,n,a){return function(r){var i,o,l,u,c,d;if(n(r),null==a||!a.includes(null==r?void 0:r.name))switch(null==r?void 0:r.name){case P.CheckoutEventNames.CHECKOUT_PAYMENT_INITIATED:e({event_name:_.VB.InitiatePayment,target_id:null==r||null===(i=r.data)||void 0===i?void 0:i.payment.method_details.type});break;case P.CheckoutEventNames.CHECKOUT_LOADED:e({event_name:_.VB.InitiateCheckout,target_id:null==r||null===(o=r.data)||void 0===o?void 0:o.payment.method_details.type});break;case P.CheckoutEventNames.CHECKOUT_PAYMENT_SELECTED:e({event_name:_.VB.SelectCheckoutPayment,target_id:null==r||null===(l=r.data)||void 0===l?void 0:l.payment.method_details.type});break;case P.CheckoutEventNames.CHECKOUT_COMPLETED:e({event_name:"gifter_id"in r.data.custom_data?_.VB.CompleteGiftCheckout:_.VB.CompleteCheckout,extra:{user_id:"gifter_id"in r.data.custom_data&&"user_id"in r.data.custom_data?r.data.custom_data.user_id:void 0,cycle:null!==(u=null==r||null===(c=r.data.items)||void 0===c||null===(c=c[0])||void 0===c||null===(c=c.billing_cycle)||void 0===c?void 0:c.interval)&&void 0!==u?u:"one-off",localCost:null==r?void 0:r.data.totals.total,localCurrency:null==r?void 0:r.data.currency_code,payment:null==r?void 0:r.data.payment.method_details.type}}),t(null==r?void 0:r.data.totals.total,null==r?void 0:r.data.currency_code,null==r||null===(d=r.data)||void 0===d?void 0:d.transaction_id);break;case"checkout.warning":e({event_name:_.VB.WarningCheckout});break;case P.CheckoutEventNames.CHECKOUT_ERROR:e({event_name:_.VB.ErrorCheckout})}}}(c,r,t,n)}),[c,r,t,n]),(0,a.useEffect)((function(){if(!(0,o.oX)()){var e=(0,P.getPaddleInstance)();e?u(e):(0,P.initializePaddle)({environment:"MISSING_ENV_VAR".NEXT_PUBLIC_PADDLE_ENVIRONMENT||"production",token:"topsecret",eventCallback:function(e){var t;null===(t=d.current)||void 0===t||t.call(d,e)}}).then((function(e){e&&u(e)}))}}),[r]),{paddle:l}},I=a.createElement;function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,l.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=function(e){var t=e.children,n=e.successCallback,r=(0,m.useRouter)(),i=(0,f.Z2)(),o=i.user,l=i.geo,c=i.isValidRegion,P=(0,h.iT)(C.N4.pricingIds),E=(0,b.L)().isPlus,_=(0,a.useCallback)((function(e){if((null==e?void 0:e.name)===s.CheckoutEventNames.CHECKOUT_COMPLETED)n?n():r.push(p.j$)}),[n,r]),w=O({paddleCallback:_}).paddle,M=(0,a.useCallback)((0,u.A)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null==w?void 0:w.PricePreview({items:Object.keys(P).map((function(e){return{priceId:e,quantity:1}})),address:(null==l?void 0:l.region)&&{countryCode:l.region}}));case 1:case"end":return e.stop()}}),e)}))),[w,P,null==l?void 0:l.region]),N=(0,v.I)({queryKey:["productPrices",o,P],queryFn:M,enabled:!!(w&&P&&l&&o)}),D=N.data,S=N.isLoading,A=(0,a.useMemo)((function(){var e,t,n,a,r=new Intl.NumberFormat(null!==(e=null===globalThis||void 0===globalThis||null===(t=globalThis.navigator)||void 0===t?void 0:t.language)&&void 0!==e?e:"en-US",{minimumFractionDigits:2});return null!==(n=null==D||null===(a=D.data)||void 0===a||null===(a=a.details)||void 0===a||null===(a=a.lineItems)||void 0===a?void 0:a.map((function(e){var t,n,a,i,o,l=!(null!==(t=e.price)&&void 0!==t&&null!==(t=t.billingCycle)&&void 0!==t&&t.interval),u="year"===(null===(n=e.price)||void 0===n||null===(n=n.billingCycle)||void 0===n?void 0:n.interval),c=l||u?g.qf.Yearly:g.qf.Monthly,d=(0,y.y8)(e),s=c===g.qf.Yearly?12:1,v=Number((d/s).toString().match(/^-?\d+(?:\.\d{0,2})?/)[0]),m=null==D?void 0:D.data.currencyCode,f=e.formattedTotals.total.replace(/\d|\.|\s|,/g,"");return{label:e.price.name,value:e.price.id,price:{amount:d,formatted:e.formattedTotals.total,monthlyAmount:v,monthlyFormatted:"".concat(f).concat(r.format(v))},currencyCode:m,currencySymbol:f,extraLabel:null===(a=e.price.customData)||void 0===a?void 0:a.label,appsId:null!==(i=null===(o=e.price.customData)||void 0===o?void 0:o.appsId)&&void 0!==i?i:g.lL.Default,duration:c,durationLabel:"month",trialPeriod:e.price.trialPeriod}})))&&void 0!==n?n:[]}),[null==D?void 0:D.data]),L=(0,a.useMemo)((function(){var e;return null===(e=A.find((function(e){return e.appsId===g.lL.EarlyAdopter})))||void 0===e?void 0:e.value}),[A]),x=(0,a.useMemo)((function(){return A.find((function(e){return e.appsId===g.lL.GiftOneYear}))}),[A]),j=(0,a.useMemo)((function(){return A.some((function(e){return!!e.trialPeriod}))}),[A]),V=(0,a.useCallback)((function(e){var t=e.priceId,n=e.giftToUserId;E&&t!==(null==x?void 0:x.value)||c&&(null==w||w.Checkout.open({items:[{priceId:t,quantity:1}],customer:T({email:null==o?void 0:o.email},(null==l?void 0:l.region)&&{address:{countryCode:null==l?void 0:l.region}}),customData:T({user_id:null!=n?n:null==o?void 0:o.id},!!n&&{gifter_id:null==o?void 0:o.id}),settings:{displayMode:"inline",variant:"one-page",frameTarget:"checkout-container",frameInitialHeight:500,frameStyle:"width: 100%; background-color: transparent; border: none;",theme:"dark"}}))}),[null==x?void 0:x.value,E,c,null==w?void 0:w.Checkout,null==o?void 0:o.email,null==o?void 0:o.id,null==l?void 0:l.region]),B=(0,a.useMemo)((function(){return{openCheckout:V,paddle:w,productOptions:A.filter((function(e){return e.value!==(null==x?void 0:x.value)})),earlyAdopterPlanId:L,isPlusAvailable:c,giftOneYear:x,isPricesPending:S,isFreeTrialExperiment:j}}),[x,L,V,w,A,c,S,j]);return I(k.Q.Provider,{value:B},t)},N=a.createElement,D=i()((function(){return n.e(4281).then(n.bind(n,74281)).then((function(e){return e.StoreKitSubProvider}))}),{loadableGenerated:{webpack:function(){return[74281]}}}),S=function(e){var t=e.children,n=e.successCallback;return(0,o.Ji)()?N(D,{successCallback:n},t):N(M,{successCallback:n},t)}},24021:()=>{},93961:()=>{}}]);